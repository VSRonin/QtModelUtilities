language: cpp

branches:
  only:
  - master
  - dev
  - travis

jobs:
  fast_finish: true
  include:
  - name: Ubuntu Static
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-9
        - g++-9
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-9"
        - CC="gcc-9"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Dynamic
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Static Many Roles
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Dynamic Many Roles
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Static No Widgets
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Dynamic  No Widgets
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Static No GUI
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Dynamic  No GUI
    os: linux
    dist: focal
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - sourceline: 'ppa:beineri/opt-qt-5.15.2-focal'
        update: true
        packages:
        - qt515base
        - qt515tools
        - gcc-6
        - g++-6
        - libc6-i386
        - libgl-dev
        - libgl1-mesa-dev
        - mesa-common-dev
    script:
        - PATH="/opt/qt515/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt515-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: Ubuntu Qt Version 5.0
    os: linux
    dist: precise
    group: stable
    services:
        - xvfb
    compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - george-edison55-precise-backports
        - sourceline: 'ppa:beineri/opt-qt502'
        update: true
        packages:
        - qtbase
        - qttools
        - gcc-6
        - g++-6
        - libc6-i386
        - cmake-data
        - cmake
    script:
        - PATH="/opt/qt5/bin:$PATH"
        - CXX="g++-6"
        - CC="gcc-6"
        - qt5-env.sh
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Static
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Dynamic
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Static Many Roles
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Dynamic Many Roles
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Static No Widgets
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Dynamic No Widgets
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Static No GUI
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt5 Dynamic No GUI
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt5
        update: true
    script:
        - PATH="/usr/local/opt/qt5/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Static
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Dynamic
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Static Many Roles
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Dynamic Many Roles
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=OFF -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=ON ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Static No Widgets
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Dynamic No Widgets
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Static No GUI
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=ON -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
  - name: MacOS Qt6 Dynamic No GUI
    os: osx
    osx_image: xcode11.3
    compiler: clang
    addons:
      homebrew:
        packages:
        - qt6
        update: true
    script:
        - PATH="/usr/local/opt/qt6/bin:$PATH"
        - mkdir ./build
        - cd ./build
        - export PATH=$PATH:$PWD/x64/lib
        - export PATH=$PATH:$PWD/x64/bin
        - cmake --version
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_TESTING=ON -DBUILD_EXAMPLES=ON -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=ON -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose
        - cmake -G"Unix Makefiles" -DCMAKE_BUILD_TYPE=DEBUG -DBUILD_TESTING=ON -DBUILD_EXAMPLES=OFF -DCMAKE_DEBUG_POSTFIX=d -DBUILD_STATIC_LIBS=OFF -DCMAKE_INSTALL_PREFIX="./installed" -DNO_WIDGETS=ON -DNO_GUI=OFF -DOPTIMISE_FOR_MANY_ROLES=OFF ../
        - cmake --build .
        - cmake --build . --target install
        - ctest --verbose

before_deploy:
- cpack -G TGZ

deploy:
  token: "${GitHubToken}"
  provider: releases
  file_glob: true
  file: "build/*.tar.gz"
  on:
    tags: true
    branch: master
    condition: $USESTATIC=OFF $NOWIDGETS=OFF
notifications:
  email: false

